# Отчет по подготовке планов ТОиР

Проект для автоматизации генерации отчетов по подготовке планов технического обслуживания и ремонта (ТОиР) на основе данных из Excel-файлов.

## Описание проекта

Скрипт автоматически формирует комплексный отчет в формате DOCX, включающий:
- Анализ данных по капитальному ремонту (КР)
- Анализ данных по техническому обслуживанию и текущему ремонту (ТОиТР)
- Визуализацию данных в виде таблиц и диаграмм
- Сводные таблицы с группировкой по подразделениям

## Технологический стек

- **Python 3.8+**
- **Pandas** - обработка и анализ данных из Excel
- **openpyxl** - работа с Excel файлами
- **matplotlib** - построение диаграмм и графиков
- **python-docx** - создание структурированных отчетов в формате DOCX
- **tempfile** - управление временными файлами

## Функциональные возможности

### 1. Обработка данных
- Чтение данных из структурированных Excel-файлов
- Предварительная обработка и нормализация значений
- Автоматическое создание сводных таблиц
- Группировка данных по подразделениям (ПО_Общества)

### 2. Аналитика и визуализация
- **Кольцевые диаграммы** для отображения распределения по планам
- **Горизонтальные столбчатые диаграммы** для визуализации статусов объектов
- **Сводные таблицы** с детализацией по категориям
- Автоматический расчет итоговых показателей

### 3. Формирование отчета
- Создание структурированного DOCX-документа
- Автоматическое форматирование таблиц (заголовки, выравнивание, заливка)
- Вставка диаграмм в соответствующие разделы
- Настройка стилей документа (шрифты, поля, межстрочные интервалы)

### 4. Управление процессами
- Проверка существования исходных файлов
- Автоматическая очистка временных файлов
- Гибкая конфигурация путей через словарь FILE_PATHS
- Обработка ошибок и логирование

## Структура проекта

```
project/
├── КР/
│   └── Проект плана КР 2027_20.xlsx     # Исходные данные по КР
├── ТОиТР/
│   └── Проект плана ТОиТР 2027.xlsx     # Исходные данные по ТОиТР
├── scripts/
│   └── report_generator.py              # Основной скрипт генерации отчетов
└── Отчет_по_подготовке_ТОиР_2027_ДД.ММ.ГГГГ.docx  # Выходной файл
```

## Основные функции

### `generate_kr_report()` и `generate_totr_report()`
- Извлекают данные из Excel-файлов
- Выполняют предварительную обработку данных
- Создают сводные таблицы с группировкой по подразделениям
- Добавляют итоговые строки

### `create_docx_report()`
- Формирует структуру отчета в формате DOCX
- Добавляет таблицы и диаграммы
- Настраивает форматирование документа
- Сохраняет итоговый файл

### Вспомогательные функции
- `check_file_exists()` - проверка доступности исходных файлов
- `create_doughnut_chart_matplotlib()` - создание кольцевых диаграмм
- `create_status_bar_chart()` - создание столбчатых диаграмм
- `save_buffer_to_temp_file()` - управление временными файлами изображений

## Запуск проекта

1. Установите зависимости:
```bash
pip install pandas openpyxl matplotlib python-docx
```

2. Настройте пути к файлам в словаре `FILE_PATHS`

3. Запустите скрипт:
```bash
python report_generator.py
```

## Особенности реализации

### Гибкая архитектура
- Разделение логики обработки данных и формирования отчета
- Возможность легкого расширения функционала
- Конфигурация через централизованный словарь путей

### Обработка ошибок
- Проверка существования исходных файлов
- Обработка исключений при работе с файлами
- Автоматическая очистка временных ресурсов

### Качественная визуализация
- Профессиональное оформление диаграмм
- Адаптивное расположение элементов
- Соответствие корпоративным стандартам оформления

### Оптимизация производительности
- Эффективная работа с большими объемами данных
- Управление памятью при работе с изображениями
- Пакетная обработка данных

## Примеры выходных данных

Отчет включает следующие разделы:

### Капитальный ремонт (КР)
1. Распределение объектов по планам
2. Статусы дефектных ведомостей (ДВ)
3. Статусы карт планирования (КП)
4. Статусы материально-технических ресурсов (МТР)
5. Передача в ОДСиССР
6. Направление на осмечивание
7. Готовность объектов

### Техническое обслуживание и текущий ремонт (ТОиТР)
Аналогичные разделы с соответствующей спецификой

## Особенности использования

- Проект настроен для работы с конкретной структурой Excel-файлов
- Требует предварительной настройки путей к исходным данным
- Автоматически генерирует имя выходного файла с текущей датой
- Поддерживает кириллические названия файлов и папок

## Примечания

- Работа с Excel и Word документами через Python
- Обработка и анализа структурированных данных
- Создания профессиональных отчетов с визуализацией
- Управления файловой системой и временными файлами
- Обработки ошибок и создания устойчивого кода
